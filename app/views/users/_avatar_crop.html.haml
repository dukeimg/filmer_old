.popup-inner#popup
  .container-fluid
    .row
      %h2.image-crop-title= t('edit-profile-picture')
      %span.btn-close.glyphicon.glyphicon-remove{'aria-hidden' => true}
  .text-center
    %p= t('crop-message')
    .flexbox.flex-center
      =image_tag current_user.avatar.url, :class => 'img-responsive', :id => 'cropbox', :style => 'max-height: 600px;'
  =form_for current_user do |f|
    -for attribute in [:crop_x, :crop_y, :crop_w, :crop_h]
      = f.hidden_field attribute, :id => attribute
    = f.submit t('save'), :class => "btn btn-default"

%script
  :plain
    $('#cropbox').Jcrop({
      aspectRatio: 1,
      onChange: update_crop,
      onSelect: update_crop
    });

    function update_crop(coords) {
      $('#crop_x').val(coords.x);
      $('#crop_y').val(coords.y);
      $('#crop_h').val(coords.h);
      $('#crop_w').val(coords.w);
      console.log(coords);
    }
